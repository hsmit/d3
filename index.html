<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>D3.js Candlestick Chart</title>
        <script type="text/javascript" src="d3.v3.js"></script>

        <style>
            body {font: 12px Arial;}
            .candle {
                stroke: black; 
                stroke-width: 1;
             }
            .bullish {
                fill: green;
            } 
            .bearish {
                fill: red;
            } 
            svg {
                border: 1px solid black;
            }
    
            .axis path, .axis line {
                fill: none;
                stroke: grey;
                stroke-width: 1;
                shape-rendering: crispEdges;
            }
            .day {
                fill: grey;
            }
            
            .day path {
                stroke: none;
                
            }
              
        </style>        
    </head>
    <body>
        <h1>D3.js Candlestick Chart</h1>
        <p>Een candlestick SVG</p>
      
        <script type="text/javascript">
           
            // dataset from exchange
            var dataset = [{"O":0.00001290,"H":0.00001321,"L":0.00001268,"C":0.00001321,"V":2373.62819019,"T":"2017-10-22T05:00:00","BV":0.03026513},{"O":0.00001296,"H":0.00001302,"L":0.00001268,"C":0.00001269,"V":6808.63113020,"T":"2017-10-22T05:30:00","BV":0.08651638},{"O":0.00001315,"H":0.00001316,"L":0.00001269,"C":0.00001315,"V":341.71275377,"T":"2017-10-22T06:00:00","BV":0.00447603},{"O":0.00001272,"H":0.00001327,"L":0.00001267,"C":0.00001327,"V":16008.62802827,"T":"2017-10-22T06:30:00","BV":0.20928033},{"O":0.00001308,"H":0.00001309,"L":0.00001268,"C":0.00001309,"V":6252.90902704,"T":"2017-10-22T07:00:00","BV":0.08136572},{"O":0.00001290,"H":0.00001290,"L":0.00001267,"C":0.00001268,"V":907.40287623,"T":"2017-10-22T07:30:00","BV":0.01157131},{"O":0.00001267,"H":0.00001326,"L":0.00001267,"C":0.00001268,"V":17101.35168884,"T":"2017-10-22T08:00:00","BV":0.21896646},{"O":0.00001295,"H":0.00001308,"L":0.00001284,"C":0.00001308,"V":1218.53783600,"T":"2017-10-22T08:30:00","BV":0.01575180},{"O":0.00001268,"H":0.00001302,"L":0.00001262,"C":0.00001262,"V":18692.72162029,"T":"2017-10-22T09:00:00","BV":0.23992190},{"O":0.00001291,"H":0.00001291,"L":0.00001237,"C":0.00001272,"V":5936.62592399,"T":"2017-10-22T09:30:00","BV":0.07364953},{"O":0.00001272,"H":0.00001279,"L":0.00001272,"C":0.00001278,"V":291.79983216,"T":"2017-10-22T10:00:00","BV":0.00372927},{"O":0.00001277,"H":0.00001285,"L":0.00001277,"C":0.00001285,"V":1737.31006972,"T":"2017-10-22T10:30:00","BV":0.02221391},{"O":0.00001298,"H":0.00001298,"L":0.00001285,"C":0.00001286,"V":2045.42629572,"T":"2017-10-22T11:00:00","BV":0.02647914},{"O":0.00001298,"H":0.00001298,"L":0.00001288,"C":0.00001288,"V":3933.79063432,"T":"2017-10-22T11:30:00","BV":0.05104467},{"O":0.00001298,"H":0.00001298,"L":0.00001291,"C":0.00001291,"V":573.42996412,"T":"2017-10-22T12:00:00","BV":0.00744035},{"O":0.00001318,"H":0.00001318,"L":0.00001237,"C":0.00001260,"V":9138.08081069,"T":"2017-10-22T12:30:00","BV":0.11743200},{"O":0.00001290,"H":0.00001290,"L":0.00001282,"C":0.00001282,"V":2280.39851275,"T":"2017-10-22T13:00:00","BV":0.02939644},{"O":0.00001263,"H":0.00001310,"L":0.00001260,"C":0.00001300,"V":13044.73724768,"T":"2017-10-22T13:30:00","BV":0.16735587},{"O":0.00001311,"H":0.00001339,"L":0.00001300,"C":0.00001339,"V":44559.56853662,"T":"2017-10-22T14:00:00","BV":0.58925141},{"O":0.00001303,"H":0.00001336,"L":0.00001301,"C":0.00001301,"V":13100.21175483,"T":"2017-10-22T14:30:00","BV":0.17064886},{"O":0.00001301,"H":0.00001365,"L":0.00001297,"C":0.00001360,"V":36551.47247471,"T":"2017-10-22T15:00:00","BV":0.48554467},{"O":0.00001360,"H":0.00001360,"L":0.00001325,"C":0.00001325,"V":5891.80511807,"T":"2017-10-22T15:30:00","BV":0.07824044},{"O":0.00001325,"H":0.00001325,"L":0.00001325,"C":0.00001325,"V":4088.97984438,"T":"2017-10-22T16:00:00","BV":0.05417897},{"O":0.00001361,"H":0.00001365,"L":0.00001326,"C":0.00001365,"V":40768.16392679,"T":"2017-10-22T16:30:00","BV":0.55015313},{"O":0.00001364,"H":0.00001364,"L":0.00001363,"C":0.00001363,"V":1740.36212676,"T":"2017-10-22T17:00:00","BV":0.02372539},{"O":0.00001363,"H":0.00001364,"L":0.00001333,"C":0.00001333,"V":5164.93989056,"T":"2017-10-22T17:30:00","BV":0.07034802},{"O":0.00001332,"H":0.00001332,"L":0.00001325,"C":0.00001326,"V":10711.92409601,"T":"2017-10-22T18:00:00","BV":0.14231846},{"O":0.00001327,"H":0.00001356,"L":0.00001327,"C":0.00001356,"V":78.94896302,"T":"2017-10-22T18:30:00","BV":0.00105852},{"O":0.00001327,"H":0.00001363,"L":0.00001327,"C":0.00001332,"V":14288.77330355,"T":"2017-10-22T19:00:00","BV":0.19342160},{"O":0.00001342,"H":0.00001363,"L":0.00001342,"C":0.00001361,"V":6713.09594493,"T":"2017-10-22T19:30:00","BV":0.09131250},{"O":0.00001362,"H":0.00001363,"L":0.00001362,"C":0.00001363,"V":3698.94020485,"T":"2017-10-22T20:00:00","BV":0.05041614},{"O":0.00001363,"H":0.00001363,"L":0.00001331,"C":0.00001331,"V":1168.66933511,"T":"2017-10-22T20:30:00","BV":0.01590685},{"O":0.00001363,"H":0.00001364,"L":0.00001330,"C":0.00001330,"V":11545.01411038,"T":"2017-10-22T21:00:00","BV":0.15609146},{"O":0.00001338,"H":0.00001364,"L":0.00001338,"C":0.00001364,"V":6664.14689914,"T":"2017-10-22T21:30:00","BV":0.09081832},{"O":0.00001365,"H":0.00001365,"L":0.00001331,"C":0.00001364,"V":5822.58187580,"T":"2017-10-22T22:00:00","BV":0.07881308},{"O":0.00001365,"H":0.00001365,"L":0.00001328,"C":0.00001328,"V":18894.04407506,"T":"2017-10-22T22:30:00","BV":0.25160253},{"O":0.00001358,"H":0.00001366,"L":0.00001328,"C":0.00001366,"V":35298.69765176,"T":"2017-10-22T23:00:00","BV":0.48019492},{"O":0.00001366,"H":0.00001366,"L":0.00001338,"C":0.00001338,"V":2517.03477799,"T":"2017-10-23T00:00:00","BV":0.03436698},{"O":0.00001332,"H":0.00001338,"L":0.00001325,"C":0.00001325,"V":5301.90920210,"T":"2017-10-23T00:30:00","BV":0.07032136},{"O":0.00001338,"H":0.00001338,"L":0.00001325,"C":0.00001328,"V":341.74979072,"T":"2017-10-23T01:00:00","BV":0.00455855},{"O":0.00001325,"H":0.00001359,"L":0.00001325,"C":0.00001359,"V":1795.91619115,"T":"2017-10-23T01:30:00","BV":0.02382141},{"O":0.00001366,"H":0.00001380,"L":0.00001366,"C":0.00001380,"V":3574.78475346,"T":"2017-10-23T02:00:00","BV":0.04920037},{"O":0.00001380,"H":0.00001380,"L":0.00001359,"C":0.00001359,"V":1044.79276002,"T":"2017-10-23T02:30:00","BV":0.01425520},{"O":0.00001380,"H":0.00001380,"L":0.00001359,"C":0.00001369,"V":266.96047148,"T":"2017-10-23T03:00:00","BV":0.00364438},{"O":0.00001341,"H":0.00001380,"L":0.00001341,"C":0.00001346,"V":1410.98848642,"T":"2017-10-23T03:30:00","BV":0.01940518},{"O":0.00001348,"H":0.00001396,"L":0.00001348,"C":0.00001350,"V":9358.12189050,"T":"2017-10-23T04:00:00","BV":0.13037936},{"O":0.00001332,"H":0.00001340,"L":0.00001304,"C":0.00001340,"V":3378.60386816,"T":"2017-10-23T04:30:00","BV":0.04412202},{"O":0.00001338,"H":0.00001340,"L":0.00001338,"C":0.00001339,"V":681.32634626,"T":"2017-10-23T05:00:00","BV":0.00912165},{"O":0.00001320,"H":0.00001321,"L":0.00001302,"C":0.00001302,"V":7059.34525059,"T":"2017-10-23T05:30:00","BV":0.09302229},{"O":0.00001301,"H":0.00001500,"L":0.00001299,"C":0.00001440,"V":125196.85296805,"T":"2017-10-23T06:00:00","BV":1.75309324},{"O":0.00001468,"H":0.00001698,"L":0.00001468,"C":0.00001548,"V":288605.06906055,"T":"2017-10-23T06:30:00","BV":4.64611485},{"O":0.00001538,"H":0.00001633,"L":0.00001517,"C":0.00001589,"V":81133.94506169,"T":"2017-10-23T07:00:00","BV":1.28283943},{"O":0.00001600,"H":0.00001664,"L":0.00001589,"C":0.00001664,"V":71592.45785473,"T":"2017-10-23T07:30:00","BV":1.17454811},{"O":0.00001660,"H":0.00001671,"L":0.00001542,"C":0.00001543,"V":131120.87084011,"T":"2017-10-23T08:00:00","BV":2.13343315},{"O":0.00001546,"H":0.00001569,"L":0.00001530,"C":0.00001530,"V":52682.95926961,"T":"2017-10-23T08:30:00","BV":0.81533023},{"O":0.00001535,"H":0.00001535,"L":0.00001433,"C":0.00001433,"V":33488.46999594,"T":"2017-10-23T09:00:00","BV":0.49958296},{"O":0.00001460,"H":0.00001569,"L":0.00001460,"C":0.00001482,"V":50153.66729241,"T":"2017-10-23T09:30:00","BV":0.76554038},{"O":0.00001491,"H":0.00001491,"L":0.00001346,"C":0.00001411,"V":180712.35749307,"T":"2017-10-23T10:00:00","BV":2.54645999},{"O":0.00001432,"H":0.00001432,"L":0.00001292,"C":0.00001300,"V":102228.28539739,"T":"2017-10-23T10:30:00","BV":1.35885592},{"O":0.00001340,"H":0.00001411,"L":0.00001318,"C":0.00001411,"V":49473.57440800,"T":"2017-10-23T11:00:00","BV":0.68489665},{"O":0.00001400,"H":0.00001430,"L":0.00001365,"C":0.00001382,"V":14702.46249437,"T":"2017-10-23T11:30:00","BV":0.20810986},{"O":0.00001390,"H":0.00001439,"L":0.00001390,"C":0.00001439,"V":43181.14818516,"T":"2017-10-23T12:00:00","BV":0.61877857},{"O":0.00001439,"H":0.00001439,"L":0.00001352,"C":0.00001352,"V":27831.37000142,"T":"2017-10-23T12:30:00","BV":0.38101530},{"O":0.00001385,"H":0.00001386,"L":0.00001354,"C":0.00001354,"V":7983.53416741,"T":"2017-10-23T13:00:00","BV":0.10935599},{"O":0.00001354,"H":0.00001384,"L":0.00001350,"C":0.00001350,"V":31329.30742680,"T":"2017-10-23T13:30:00","BV":0.42484856},{"O":0.00001349,"H":0.00001390,"L":0.00001349,"C":0.00001390,"V":25218.19228228,"T":"2017-10-23T14:00:00","BV":0.34241191},{"O":0.00001396,"H":0.00001418,"L":0.00001396,"C":0.00001401,"V":5006.35319322,"T":"2017-10-23T14:30:00","BV":0.07059800},{"O":0.00001401,"H":0.00001418,"L":0.00001380,"C":0.00001380,"V":26601.58807987,"T":"2017-10-23T15:00:00","BV":0.37335290},{"O":0.00001418,"H":0.00001422,"L":0.00001380,"C":0.00001380,"V":61823.57124802,"T":"2017-10-23T15:30:00","BV":0.87295975},{"O":0.00001419,"H":0.00001578,"L":0.00001380,"C":0.00001578,"V":86198.15024547,"T":"2017-10-23T16:00:00","BV":1.27476134},{"O":0.00001581,"H":0.00002011,"L":0.00001580,"C":0.00001901,"V":1130467.05213522,"T":"2017-10-23T16:30:00","BV":20.70404518},{"O":0.00001898,"H":0.00002000,"L":0.00001653,"C":0.00001790,"V":594128.55916860,"T":"2017-10-23T17:00:00","BV":10.79886285},{"O":0.00001789,"H":0.00001900,"L":0.00001743,"C":0.00001842,"V":340862.20380862,"T":"2017-10-23T17:30:00","BV":6.21721018},{"O":0.00001852,"H":0.00001946,"L":0.00001765,"C":0.00001900,"V":261099.86474904,"T":"2017-10-23T18:00:00","BV":4.89645127},{"O":0.00001849,"H":0.00001900,"L":0.00001765,"C":0.00001860,"V":169889.12815056,"T":"2017-10-23T18:30:00","BV":3.12508475},{"O":0.00001860,"H":0.00002130,"L":0.00001860,"C":0.00002041,"V":788251.05913272,"T":"2017-10-23T19:00:00","BV":15.96061019},{"O":0.00002058,"H":0.00002058,"L":0.00001589,"C":0.00002010,"V":516141.67720452,"T":"2017-10-23T19:30:00","BV":9.61728522},{"O":0.00002010,"H":0.00002022,"L":0.00001818,"C":0.00001839,"V":282634.96156622,"T":"2017-10-23T20:00:00","BV":5.34623476},{"O":0.00001830,"H":0.00001830,"L":0.00001692,"C":0.00001741,"V":204640.55834067,"T":"2017-10-23T20:30:00","BV":3.54966728},{"O":0.00001741,"H":0.00001810,"L":0.00001723,"C":0.00001723,"V":102228.71366537,"T":"2017-10-23T21:00:00","BV":1.80552875},{"O":0.00001723,"H":0.00001805,"L":0.00001685,"C":0.00001771,"V":120857.20736389,"T":"2017-10-23T21:30:00","BV":2.11797406},{"O":0.00001771,"H":0.00002006,"L":0.00001771,"C":0.00001950,"V":323768.98703510,"T":"2017-10-23T22:00:00","BV":6.23340055},{"O":0.00001960,"H":0.00002215,"L":0.00001960,"C":0.00002037,"V":768594.88268185,"T":"2017-10-23T22:30:00","BV":15.93552147},{"O":0.00002037,"H":0.00002177,"L":0.00001960,"C":0.00002068,"V":148313.50513442,"T":"2017-10-23T23:00:00","BV":3.03935998},{"O":0.00002068,"H":0.00002137,"L":0.00001929,"C":0.00001975,"V":273917.16481351,"T":"2017-10-23T23:30:00","BV":5.49480895},{"O":0.00001929,"H":0.00001947,"L":0.00001854,"C":0.00001937,"V":124186.23806840,"T":"2017-10-24T00:00:00","BV":2.36047071},{"O":0.00001937,"H":0.00002172,"L":0.00001837,"C":0.00001870,"V":748128.57037796,"T":"2017-10-24T00:30:00","BV":15.34249860},{"O":0.00001844,"H":0.00001916,"L":0.00001760,"C":0.00001848,"V":327598.29263187,"T":"2017-10-24T01:00:00","BV":5.91187002},{"O":0.00001800,"H":0.00001848,"L":0.00001701,"C":0.00001752,"V":139389.59846805,"T":"2017-10-24T01:30:00","BV":2.47468600},{"O":0.00001784,"H":0.00001784,"L":0.00001609,"C":0.00001725,"V":380527.92425652,"T":"2017-10-24T02:00:00","BV":6.44744726},{"O":0.00001720,"H":0.00001724,"L":0.00001627,"C":0.00001704,"V":53104.43011785,"T":"2017-10-24T02:30:00","BV":0.89743172},{"O":0.00001704,"H":0.00001704,"L":0.00001640,"C":0.00001694,"V":22943.02830689,"T":"2017-10-24T03:00:00","BV":0.38019207},{"O":0.00001694,"H":0.00001775,"L":0.00001673,"C":0.00001769,"V":144729.38181516,"T":"2017-10-24T03:30:00","BV":2.49089406},{"O":0.00001769,"H":0.00001882,"L":0.00001769,"C":0.00001879,"V":249326.24256189,"T":"2017-10-24T04:00:00","BV":4.54483533},{"O":0.00001877,"H":0.00001877,"L":0.00001729,"C":0.00001771,"V":87956.34888338,"T":"2017-10-24T04:30:00","BV":1.58089786},{"O":0.00001756,"H":0.00001756,"L":0.00001720,"C":0.00001720,"V":24874.37062821,"T":"2017-10-24T05:00:00","BV":0.43511606},{"O":0.00001720,"H":0.00001732,"L":0.00001680,"C":0.00001730,"V":125262.20063498,"T":"2017-10-24T05:30:00","BV":2.12508873},{"O":0.00001724,"H":0.00001724,"L":0.00001700,"C":0.00001707,"V":10698.44110556,"T":"2017-10-24T06:00:00","BV":0.18307465},{"O":0.00001707,"H":0.00001889,"L":0.00001681,"C":0.00001799,"V":277931.44751019,"T":"2017-10-24T06:30:00","BV":5.03879418},{"O":0.00001814,"H":0.00001824,"L":0.00001731,"C":0.00001820,"V":162900.87248542,"T":"2017-10-24T07:00:00","BV":2.93159726},{"O":0.00001824,"H":0.00001850,"L":0.00001783,"C":0.00001783,"V":26940.67968131,"T":"2017-10-24T07:30:00","BV":0.48983082},{"O":0.00001767,"H":0.00001817,"L":0.00001767,"C":0.00001817,"V":38572.07003077,"T":"2017-10-24T08:00:00","BV":0.69432608},{"O":0.00001820,"H":0.00001843,"L":0.00001795,"C":0.00001796,"V":41196.70610616,"T":"2017-10-24T08:30:00","BV":0.75207482},{"O":0.00001797,"H":0.00001824,"L":0.00001795,"C":0.00001795,"V":50965.61688314,"T":"2017-10-24T09:00:00","BV":0.91682635},{"O":0.00001794,"H":0.00001794,"L":0.00001749,"C":0.00001750,"V":65283.48086877,"T":"2017-10-24T09:30:00","BV":1.14414681},{"O":0.00001749,"H":0.00001750,"L":0.00001704,"C":0.00001704,"V":57389.99423669,"T":"2017-10-24T10:00:00","BV":0.99814060},{"O":0.00001722,"H":0.00001781,"L":0.00001712,"C":0.00001769,"V":50497.95960090,"T":"2017-10-24T10:30:00","BV":0.87819494},{"O":0.00001766,"H":0.00001766,"L":0.00001722,"C":0.00001732,"V":17135.78228715,"T":"2017-10-24T11:00:00","BV":0.29879487},{"O":0.00001749,"H":0.00001796,"L":0.00001724,"C":0.00001771,"V":38326.43268134,"T":"2017-10-24T11:30:00","BV":0.67645341},{"O":0.00001732,"H":0.00001755,"L":0.00001724,"C":0.00001725,"V":33709.21585417,"T":"2017-10-24T12:00:00","BV":0.58296047},{"O":0.00001725,"H":0.00001764,"L":0.00001700,"C":0.00001743,"V":108698.52324457,"T":"2017-10-24T12:30:00","BV":1.86589344},{"O":0.00001737,"H":0.00001743,"L":0.00001700,"C":0.00001721,"V":33179.74954637,"T":"2017-10-24T13:00:00","BV":0.56878819},{"O":0.00001740,"H":0.00001749,"L":0.00001740,"C":0.00001744,"V":15481.98414443,"T":"2017-10-24T13:30:00","BV":0.26962915},{"O":0.00001749,"H":0.00001796,"L":0.00001748,"C":0.00001793,"V":18376.13551076,"T":"2017-10-24T14:00:00","BV":0.32822734},{"O":0.00001796,"H":0.00001850,"L":0.00001771,"C":0.00001845,"V":82055.32616299,"T":"2017-10-24T14:30:00","BV":1.49207393},{"O":0.00001845,"H":0.00001845,"L":0.00001747,"C":0.00001779,"V":56034.48765018,"T":"2017-10-24T15:00:00","BV":0.99715718},{"O":0.00001780,"H":0.00001800,"L":0.00001760,"C":0.00001800,"V":45670.74224638,"T":"2017-10-24T15:30:00","BV":0.81117930},{"O":0.00001800,"H":0.00001832,"L":0.00001800,"C":0.00001823,"V":15255.38344169,"T":"2017-10-24T16:00:00","BV":0.27651332},{"O":0.00001825,"H":0.00001884,"L":0.00001823,"C":0.00001841,"V":140618.09525716,"T":"2017-10-24T16:30:00","BV":2.60879526},{"O":0.00001840,"H":0.00001930,"L":0.00001840,"C":0.00001862,"V":109968.05547058,"T":"2017-10-24T17:00:00","BV":2.07203425},{"O":0.00001875,"H":0.00001891,"L":0.00001824,"C":0.00001864,"V":26460.37710991,"T":"2017-10-24T17:30:00","BV":0.48948437},{"O":0.00001864,"H":0.00001899,"L":0.00001856,"C":0.00001856,"V":38615.39368685,"T":"2017-10-24T18:00:00","BV":0.72158598},{"O":0.00001856,"H":0.00001878,"L":0.00001830,"C":0.00001830,"V":85685.00442345,"T":"2017-10-24T18:30:00","BV":1.59474551},{"O":0.00001872,"H":0.00001878,"L":0.00001861,"C":0.00001878,"V":42112.32098402,"T":"2017-10-24T19:00:00","BV":0.78668494},{"O":0.00001878,"H":0.00001897,"L":0.00001723,"C":0.00001850,"V":180172.33086600,"T":"2017-10-24T19:30:00","BV":3.23964744},{"O":0.00001850,"H":0.00001874,"L":0.00001850,"C":0.00001852,"V":28569.70213438,"T":"2017-10-24T20:00:00","BV":0.53138652},{"O":0.00001852,"H":0.00001866,"L":0.00001730,"C":0.00001751,"V":57788.82754350,"T":"2017-10-24T20:30:00","BV":1.03052576},{"O":0.00001780,"H":0.00001838,"L":0.00001780,"C":0.00001790,"V":78841.48679667,"T":"2017-10-24T21:00:00","BV":1.43795986},{"O":0.00001810,"H":0.00001817,"L":0.00001748,"C":0.00001748,"V":35909.22932325,"T":"2017-10-24T21:30:00","BV":0.63908842},{"O":0.00001748,"H":0.00001816,"L":0.00001737,"C":0.00001815,"V":41890.62396394,"T":"2017-10-24T22:00:00","BV":0.74198820}]
            
            // sizes
            var marginRight = 90, marginBottom = 63, space = 0,
                paddingLeft = 5, paddingRight = 5, paddingTop = 5, paddingBottom = 5,
                chartWidth = 555, chartHeight = 360,
                yearOffset = 35,
                svgWidth = chartWidth + marginRight,
                svgHeight = chartHeight + marginBottom;

            // format dataset
            dataset.forEach(function(d) {
                d.L = +d.L;
                d.H = +d.H;
                d.O = +d.O;
                d.C = +d.C;
                d.V = +d.V;
                d.BV = +d.BV;
                d.T = d3.time.format("%Y-%m-%dT%H:%M:%S").parse(d.T);
                d.bullish = d.O < d.C;
            });
              
            // data analysis   
            var min = d3.min(dataset, function(d) { return  d.L; });
            var max = d3.max(dataset, function(d) { return  d.H; });
            var [minDate, maxDate] = d3.extent(dataset, function(d) { return d.T;});
            var bins = dataset.length;
            var barWidth = (chartWidth/bins) - (space/2);
            var intervalMs = dataset[1].T.getTime() - dataset[0].T.getTime();
            
            var minDate2 = new Date(minDate.getTime() - intervalMs/2);
            var maxDate2 = new Date(maxDate.getTime() + intervalMs/2);
            
            
            // scales
            var yScale = d3.scale.linear()
                .domain([min, max]).range([chartHeight, 0]);
            var xScale = d3.time.scale()
                .domain([minDate2, maxDate2])
                .range([0, chartWidth]);

            // SVG chart
            var chart = d3.select("body")
                .append("svg")
                .attr("width", svgWidth)
                .attr("height", svgHeight);

            // draw axis
            // Y axis
            var yAxis = d3.svg.axis()
                .scale(yScale)
                .orient("right")
                .ticks(5)
                .tickFormat(d3.format(".8f"));
            chart.append("g")
                .attr("transform", "translate(" + (paddingLeft + chartWidth + paddingRight)+ ", " + paddingTop + " )")
                .style("fill", "black")	
                .attr("class", "axis")	
                .call(yAxis);
            // X axis - minutes
            var xAxisTime = d3.svg.axis()
                .scale(xScale)
                .orient("bottom")
                .ticks(8)
                .tickFormat(d3.time.format("%H:%M"));
            chart.append("g")
                .attr("transform", "translate("+paddingLeft+", " + (chartHeight+10)+ ")")
                .style("fill", "black")	
                .attr("class", "axis")	
                .call(xAxisTime);
            // X axis - date
            var xAxisDate = d3.svg.axis()
                .scale(xScale)
                .orient("bottom")
                .ticks(d3.time.days, 1)
                .tickFormat(d3.time.format("%Y-%m-%d"));
            chart.append("g")
                .attr("transform", "translate("+paddingLeft+", " + (chartHeight+yearOffset)+ ")")
                .attr("class", "axis day")	
                .call(xAxisDate);
                

            // shadow lines          
            chart.selectAll("line.shadow")
                .data(dataset)
                .enter()
                .append("line")
                    .attr("class", "shadow")
                    .attr("transform", "translate("+5+", " + paddingTop + ")")
                    .attr("x1", function(d) {return xScale(d.T);})
                    .attr("y1", function(d) {  return yScale(d.H);})
                    .attr("x2", function(d) {return xScale(d.T);})
                    .attr("y2", function(d) { return  yScale(d.L);})
                    .attr("stroke", "black")
                    .attr("stroke-width", 1);


            // candles
            chart.selectAll("rect.candle")
                .data(dataset)
                .enter()
                .append("rect")
                    .attr("class", function(d) { return "candle " + (d.bullish ? "bullish" : "bearish");})
                    .attr("transform", "translate(5, " + paddingTop + ")")
                    .attr("x", function(d) {return xScale(d.T)-(barWidth/2);})
                    .attr("y", function(d, i) {return Math.min(yScale(+d.O), yScale(+d.C)); })
                    .attr("height", function(d) {
                        return Math.max(yScale(+d.O), yScale(+d.C)) - Math.min(yScale(+d.O), yScale(+d.C))+0.1; })
                    .attr("width", barWidth);
        </script>
        
    </body>
</html>
